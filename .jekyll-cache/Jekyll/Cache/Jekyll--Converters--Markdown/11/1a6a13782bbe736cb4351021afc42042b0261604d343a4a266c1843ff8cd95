I"~><h1 id="iot---altitude-and-pressure-sensor-hookup-guide---mae540-2017-team-9">IoT - Altitude and pressure sensor hookup guide - MAE540-2017 Team 9</h1>
<p>By Surya Prakash Reddy Dasari, Kevin Espinoza, Nikhil Sunil Kadway, Satya Pattela, Xinyu Wang</p>

<h2 id="introduction">Introduction</h2>
<p>The purpose of this experiment is to introduce an altitude/pressure sensor. This report will include a schematic of the hookup, Arduino code, and all related installation guide. In addition, the report will include a discussion of how the experiment functioned, and new knowledge of the sensor.</p>

<ol>
  <li><strong>A narrative of the application</strong></li>
  <li><strong>An introduction to the sensor</strong></li>
  <li><strong>A schematic of the hookup</strong></li>
  <li><strong>The Arduino code and related installation guide of  necessary packages</strong></li>
  <li><strong>The experiment and discussion</strong></li>
</ol>

<h2 id="narrative-of-the-application">Narrative of the Application</h2>

<p>Aerospace major wildly uses the accurate barometric pressure sensors such as MPL3115A2
pressure sensor; ambient pressure and temperature are basic parameters in most aerospace
applications. For example, a classic aerospace experiment always sets pressure gauges before and
after the test section to analyze the flow of state change around the model. Typically, a wind
tunnel creates the flow. The advantage of the MPL3115A2 sensor is that it can measure the
pressure and temperature at the same time. Hence, the idea gas law could easily calculate the
corresponding density in each state. To use, the MPL3115A2 to measure the pressure altitude
because the relationship between pressure and altitude within the atmosphere is descried by a
simple formula, and pressure and temperature are one-to-one correspondence.</p>

<h2 id="a-schematic-of-the-hookup">A Schematic of the Hookup</h2>

<h3 id="item-list">Item List</h3>

<ol>
  <li><a href="https://www.sparkfun.com/products/13711">Arduino ESP8266</a></li>
  <li><a href="https://www.sparkfun.com/products/11084">Altitude/Pressure sensor</a></li>
  <li><a href="https://www.adafruit.com/product/64">Breadboard</a></li>
  <li><a href="https://solarbotics.com/product/45040/">Jumper wires male-male</a></li>
  <li><a href="https://www.sparkfun.com/products/12016">USB wires</a></li>
</ol>

<h3 id="hardware-setup">Hardware setup</h3>
<p>To test the basic functionality, we will use the following hookup:</p>

<ol>
  <li>
    <p>Connect <strong>Micro-B</strong> to <strong>Arduino ESP8266</strong>.
<img src="http://i65.tinypic.com/2885ibr.jpg" alt="caption" /></p>
  </li>
  <li>
    <p>Connect <strong>USB-A</strong> to <strong>Laptop</strong>.
<img src="http://i63.tinypic.com/14nfy4z.jpg" alt="caption" /></p>
  </li>
  <li>
    <p>Connect <strong>Mini-B</strong> to <strong>FTDI</strong>.
<img src="http://i64.tinypic.com/2vchvrr.jpg" alt="caption" /></p>
  </li>
  <li>
    <p>Connect <strong>FTDI</strong> to <strong>Arduino ESP8266</strong> via <strong>Jumper wires</strong> following this order:
GND-GND
CTS-NC
3V3-3V3
RXI-RXI
TXO-TXO
DTR-DTR</p>
    <ol>
      <li>Connect the <strong>Altitude/Pressure sensor Breakout - MPL3115A2</strong> to <strong>Arduino ESP8266</strong> via <strong>Jumper wires</strong> following this order:
GND-GND
3V3-VVC
SCL-SCL
SDA-SDA
<img src="http://i66.tinypic.com/2upz48x.jpg" alt="caption" /></li>
    </ol>
  </li>
</ol>

<p><strong>Note:</strong> You can also you the SDA and SCL lines on Arduino boards that have them broken out. Make sure you edit the code accordingly if you use those pins instead.
On an Arduino board connect the SDA pin on the breakout board to A4 and SCL to A5. If you’re using a 5V Arduino Uno we recommend putting 330 ohm resistors in line to limit the 5V signal going into the sensor and prevent damage to the sensor.</p>

<ol>
  <li>
    <p>Place the <strong>Arduino ESP8266</strong> to the <strong>Bread Board</strong>.</p>
  </li>
  <li>
    <p>Switch on the button on the ESP8266 chip to check whether the connections are accurate. A led will glow which confirms the connection are accurate.
<img src="http://i65.tinypic.com/2ahkj4.jpg" alt="caption" /></p>
  </li>
  <li>
    <p>Final look after completing hookup.
<img src="http://i63.tinypic.com/302wexi.jpg" alt="caption" /></p>
  </li>
</ol>

<h3 id="software-setup">Software setup</h3>

<p>The following setup should work for both Windows and Linux.</p>

<p><strong>ARDUINO code for accessing the Altitude/Pressure sensor:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #include &lt;Wire.h&gt; 
  #include &lt;ESP8266WiFi.h&gt;
  #include &lt;BlynkSimpleEsp8266.h&gt;
  #include "SparkFunMPL3115A2.h"
  
// You should get Auth Token in the Blynk App.
// Go to the Project Settings (nut icon).
char auth[] = "***"; // ***Type in your Blynk Token
  
// Your WiFi credentials.
// Set password to "" for open networks.
char ssid[] = "***"; ***your wifi name
char pass[] = "***"; ***and password
  
// pressure
MPL3115A2 myPressure;
float pressure = 0;
float tempf = 0;
  
void setup()
{
  Wire.begin();        // Join i2c bus
  myPressure.begin(); // Get sensor online
  
// Configure the sensor
//myPressure.setModeAltimeter(); // Measure altitude above sea level in meters
myPressure.setModeBarometer(); // Measure pressure in Pascals from 20 to 110 kPa
  
myPressure.setOversampleRate(7); // Set Oversample to the recommended 128
myPressure.enableEventFlags(); // Enable all three pressure and temp event flags
  
Blynk.begin(auth, ssid, pass);
}
  
void loop()
{
  Blynk.run();
  getPressure();
}
  
void getPressure()
   {
      pressure = myPressure.readPressure();
      tempf = myPressure.readTempF();
      Blynk.virtualWrite(0, tempf);
      Blynk.virtualWrite(1, pressure);
    }  ![caption](http://i67.tinypic.com/15g775w.png) 
</code></pre></div></div>

<p><strong>Installation guide:</strong></p>

<ol>
  <li>
    <p>Download and Install the <a href="https://www.sparkfun.com/products/13754">Arduino IDE</a>.</p>
  </li>
  <li>
    <p>Open the Arduino IDE and follow the following steps:</p>

    <p>a) Go to <strong>File &gt; Preference</strong>, and type the string ‘http://arduino.esp8266.com/stable/package_esp8266com_index.json’ into the “Additional Board Manager URLs” text box and click OK.
<img src="http://i67.tinypic.com/29asle1.jpg" alt="caption" /></p>

    <p>b) Next step is installing “esp8266”. Go to <strong>Tools &gt; Boards &gt; Boards Manager</strong>, search “esp8266”, and install it.
<img src="http://i64.tinypic.com/2rfejx0.jpg" alt="caption" /></p>

    <p>c) After installing “esp8266”,select “SparkFun ESP8266 Thing” under <strong>Tools &gt; Boards</strong>.
<img src="http://i67.tinypic.com/168a5c7.jpg" alt="caption" /></p>
  </li>
  <li>
    <p>Depending on the type of sensor used its corresponding library files are to be downloaded. After downloading, the files are to be unzipped and are moved to <strong>»Documents»Arduino»Libraries</strong>.
For the Altitude/Pressure the library file to be downloaded is <a href="https://github.com/sparkfun/SparkFun_MPL3115A2_Breakout_Arduino_Library/archive/master.zip">ITS LIBRARY</a>. Restart Arduino IDE and check to see if you have <strong>SparkFun MPL3115A2 Altitude and Pressure Sensor Breakout</strong> under <strong>File&gt;Examples</strong>. 
<img src="http://i66.tinypic.com/2hxx0ep.jpg" alt="caption" /></p>

    <p>a) Turn the thing on with the help of switch on one corner. We can see a red light once board is on.</p>

    <p>b) In the IDE, check <strong>Tools&gt;Port</strong> to see which serial port you are using. Remember that both the Thing and the FTDI are hooked up through USB, the one we should use is the USB Serial Port rather than Communications Port. To find the right port, go to Device Manager (on Windows, it’s under <strong>Control Panel&gt;System and Security&gt;System</strong>) and check “<strong>Ports</strong>”.
<img src="http://i64.tinypic.com/24gt5zd.jpg" alt="caption" /></p>

    <p>c) Sensor can be turned on/off and readings can be taken with the application called <strong>BLYNK</strong>.</p>

    <p>d) Download the <a href="https://github.com/blynkkk/blynk-library">Blynk library</a>. Unzip it and move it to <strong>»Documents»Arduino»Libraries</strong>.</p>
  </li>
</ol>

<p><strong>Blynk setup:</strong></p>

<ol>
  <li>
    <p>Download and install the Blynk app in smart phone.</p>
  </li>
  <li>
    <p>Start the app after entering the login details.</p>
  </li>
  <li>
    <p>Clink on the New Project and give a title to it accordingly.
<img src="http://i65.tinypic.com/2eb7ja0.png" alt="caption" /> <br />
<img src="http://i63.tinypic.com/r8z0qb.png" alt="caption" /></p>
  </li>
</ol>

<p>4.Go to project settings and get Auth Token to an E-mail by which, Blynk is registered by clicking on “Email all” and type it into the Arduino Sketch code.</p>

<ol>
  <li>
    <p>Then under the New Project, create the following:</p>

    <p>a) Select the required buttons by tapping on the screen from Widget box.</p>

    <p>b) A <strong>button</strong>: Set output of the button to “Digital - GP5”, this particular pin corresponds to the LED on the Thing board.
<img src="http://i68.tinypic.com/bfmlqv.png" alt="caption" />  <img src="http://i65.tinypic.com/b5mxc8.png" alt="caption" />
<img src="http://i66.tinypic.com/1zml3c7.png" alt="Caption" /></p>

    <p>c) Two value displays: Set the inputs to <strong>Virtual - V0</strong> and <strong>Virtual - V1</strong>, respectively.</p>

    <p>d) We can also add the parameter names to the virtual value v0 and v1 and in this project the names the parameter readings shown for Temperature(F0) and Pressure(pascal).
<img src="http://i63.tinypic.com/2z71hg7.png" alt="caption" />  <img src="http://i67.tinypic.com/1zq7qbq.png" alt="caption" /></p>

    <p>e) By following the above steps, we are just one step away from running the application. The Button is turned ON and we can see the values for temperature(F0) and pressure(Pascal) for v0 and v1 respectively.
<img src="http://i67.tinypic.com/euj512.png" alt="caption" /></p>
  </li>
</ol>

<h2 id="the-experiment-and-discussion">The Experiment and Discussion</h2>

<p>For testion our Altitude/ Pressure sensore we carried out the following experiments:</p>

<ol>
  <li>Exposing the sensor to different temperatures.
  a) Contact with a cold object.
  b) Contact with a hot object.</li>
  <li>Exposing the sensor to different pressures.
  a) Exposing the sensor within a pressure close to vaccum.
  b) Exposing the sensor within atmospheric pressure.</li>
</ol>

<h3 id="checking-for-an-error">Checking for an ERROR</h3>

<p>Before performing any experiment it is essential to check whether the instrumets inspite functioning and showing results are there any errors in the readings. So we decided to confirm the readings with the temperature controller and sensor of our appartment to check the temperature readings only. Fortunately we witnessed no error in the sensor and hence we carried on with our experiments.
<img src="http://i66.tinypic.com/27wzpg4.jpg" alt="caption" /></p>

<p><strong>1.a) Exposing the sensor to a cold object</strong>.</p>

<p>Initially we planned to keep the sensor inside the refrigerator, but, later we realized that as soon as we bring the temperature back to normal temperature the surface of the sensor becaome wet due to obvious reason can damage the sensor. So to minimize this threat we made a physical contact between the sensor and an object from thr refridgetor inside an enviornment in room temperature.
<img src="http://i66.tinypic.com/33wmceb.jpg" alt="caption" /></p>

<p>Doing so we witnessed a <strong>drastic drop</strong> in the temperature and a <strong>fine and steady drop</strong> in the pressure. The room temperature is <strong>76.66</strong> degree F where as the object temperature measured by the sensor is <strong>41.9</strong> degree F. Similarly the atmospheric pressure from <strong>97809.5</strong> pascal came down to <strong>97718</strong> pascal. 
 So basically there is a temperature difference of <strong>34.76</strong> degree F.
 Pressure drop of <strong>91.5</strong> pascal.
 <img src="http://i63.tinypic.com/30avrir.jpg" alt="caption" /></p>

<p><strong>1.b)  Exposing the sensor to a hot object.</strong></p>

<p>Here the hot object in nothing but a human hand which has a temperature more than room temperature, mainly due to blood and the chemical reactions inside the stomach.
 By doing so we witnessed a <strong>steady rise</strong> in temperature and a <strong>fine and steady drop</strong> in the pressure. Again the room temperature is <strong>76.66</strong> degree F where as the object temperature measured by the sensor is <strong>92.975</strong> degree F. Similarly the atmospheric pressure from <strong>97809.5</strong> pascal came down to <strong>97756</strong> pascal. 
 So basically there is a temperature difference of <strong>53.5</strong> degree F.
 Pressure drop of <strong>69.25</strong> pascal.
 <img src="http://i63.tinypic.com/20ts1du.jpg" alt="caption" /></p>

<p><strong>2.a)  Exposing the sensor within a pressure close to vaccum.</strong></p>

<p>As its very difficult to achieve vaccum, so we tried to create some as much as we could. So we took a plastic bottle and created a hole on the bottle cap, further we inserted a straw so as to suck the air inside the bottle to create a vaccum. The team inserted the sensor inside the bottle to measure the pressure.
Finally the team got readings, <strong>89463.0</strong> pascals and temperature <strong>62.487</strong> degree F.</p>

<p>So basically there is a temperature difference of <strong>14.173</strong> degree F.
 Pressure drop of <strong>8346.5</strong> pascal.
 <img src="http://i66.tinypic.com/1222exc.jpg" alt="caption" /> <img src="http://i66.tinypic.com/2qurxc4.png" alt="caption" /></p>

<p><strong>2.b)  Exposing the sensor within atmospheric pressure.</strong></p>

<p>As per the data provided by <strong>WEATHERFORYOU.COM</strong> the atm pressure in pascal at the time we measured the pressure on sensor was <strong>101264</strong> pascal. But as per our reading we got a pressure reading in our house which is <strong>97809.5</strong>. Which shows a huge drop in pressure. Generally speaking we wont consider the sensor reading to be accurate because considering a temperature of 76 degree F and the current atmosphere of Tempe AZ 97824.25 is very less pressure. Practically we think the sensor is showing an error.
<img src="http://i66.tinypic.com/27wzpg4.jpg" alt="caption" /></p>

<h3 id="advantages-and-disadvantages-of-altitudepressure-sensor">Advantages and Disadvantages of Altitude/Pressure sensor</h3>

<h4 id="advantages">ADVANTAGES</h4>

<ol>
  <li>Fully Compensated internally</li>
  <li>1.6V to 3.6V Digital Interface Supply Voltage</li>
  <li>I2C digital output interface (operates up to 400 kHz)</li>
  <li>Direct Reading, Compensated</li>
  <li>Pressure: 20-bit measurement (Pascals)</li>
  <li>Altitude: 20-bit measurement (meters)</li>
  <li>Temperature: 12-bit measurement (degrees Celsius)</li>
  <li>Programmable Events</li>
  <li>Autonomous Data Acquisition
11.32 Sample FIFO
12 Ability to log data up to 12 days using the FIFO
13.1 second to 9 hour data acquisition rate
14.1.95V to 3.6V Supply Voltage, internally regulated by LDO</li>
</ol>

<h4 id="disadvantages">DISADVANTAGES</h4>

<ol>
  <li>Its not portable, as we have to carry laptop along with the sensor everytime.</li>
  <li>Its not water resistant.</li>
  <li>It does not measure extreme high temperatures.</li>
</ol>

<h2 id="conclusion">CONCLUSION</h2>

<p>From the tests which our team conducted, we can say that the sensor is fully functional. The temperature sensor is accurate though the pressure is not. The hookup is very easy to understand and easy to control through a smartphone via Blynk.</p>
:ET